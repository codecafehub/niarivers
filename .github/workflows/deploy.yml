name: Minimal Deployment Test

on:
  push:
    branches:
      - master

jobs:
  deploy:
    name: Minimal SCP Deploy Test
    runs-on: ubuntu-latest

    steps:
      # Step 1: Check out the repository so we have files to copy
      - name: Checkout Code
        uses: actions/checkout@v4

      # Step 2: Attempt to copy all files to the server
      # Using a single file like README.md is even faster for testing
      - name: Deploy files using SCP
        uses: appleboy/scp-action@v0.1.7
        with:
          host: ${{ secrets.MAIN_HOST }}
          username: ${{ secrets.MAIN_USERNAME }}
          password: ${{ secrets.MAIN_PASSWORD }}
          port: ${{ secrets.MAIN_PORT }}
          source: "." # The entire directory
          target: ${{ secrets.PROJECT_PATH }}
          overwrite: true